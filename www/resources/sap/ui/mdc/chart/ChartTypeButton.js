/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2018 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/m/Button","sap/m/ButtonRenderer","sap/ui/model/base/ManagedObjectModel","sap/ui/base/ManagedObjectObserver"],function(B,a,M,b){"use strict";var R,L,c,S,d,I,D,r;var C=B.extend("sap.ui.mdc.chart.ChartTypeButton",{constructor:function(o){this.oChartModel=new M(o);var s={type:"Transparent",press:function(e){this.displayChartTypes(e.getSource(),o);}.bind(this),id:o.getId()+"-btnChartType",icon:'{$chart>/getTypeInfo/icon}',tooltip:'{$chart>/getTypeInfo/text}'};this.oChart=o;B.apply(this,[s]);this.setModel(this.oChartModel,"$chart");this._oObserver=new b(function(){this.oChartModel.checkUpdate(true);}.bind(this));this._oObserver.observe(this.oChart,{aggregations:["items"],properties:["chartType"]});},renderer:a.render});C.mMatchingIcon={"bar":"sap-icon://horizontal-bar-chart","bullet":"sap-icon://horizontal-bullet-chart","bubble":"sap-icon://bubble-chart","column":"sap-icon://vertical-bar-chart","combination":"sap-icon://business-objects-experience","dual_bar":"sap-icon://horizontal-bar-chart","dual_column":"sap-icon://vertical-bar-chart","dual_combination":"sap-icon://business-objects-experience","dual_horizontal_combination":"sap-icon://business-objects-experience","dual_horizontal_stacked_combination":"sap-icon://business-objects-experience","dual_line":"sap-icon://line-chart","dual_stacked_bar":"sap-icon://full-stacked-chart","dual_stacked_column":"sap-icon://vertical-stacked-chart","dual_stacked_combination":"sap-icon://business-objects-experience","donut":"sap-icon://donut-chart","heatmap":"sap-icon://heatmap-chart","horizontal_stacked_combination":"sap-icon://business-objects-experience","line":"sap-icon://line-chart","pie":"sap-icon://pie-chart","scatter":"sap-icon://scatter-chart","stacked_bar":"sap-icon://full-stacked-chart","stacked_column":"sap-icon://vertical-stacked-chart","stacked_combination":"sap-icon://business-objects-experience","treemap":"sap-icon://Chart-Tree-Map","vertical_bullet":"sap-icon://vertical-bullet-chart","100_dual_stacked_bar":"sap-icon://full-stacked-chart","100_dual_stacked_column":"sap-icon://vertical-stacked-chart","100_stacked_bar":"sap-icon://full-stacked-chart","100_stacked_column":"sap-icon://full-stacked-column-chart","waterfall":"sap-icon://vertical-waterfall-chart","horizontal_waterfall":"sap-icon://horizontal-waterfall-chart"};C.prototype.displayChartTypes=function(o,e){if(!e||!o){return;}if(this.oPopover){return this.oPopover.openBy(o);}if(!this.oReadyPromise){this.oReadyPromise=new Promise(function(f){if(R){f(true);}else{sap.ui.require(["sap/m/ResponsivePopover","sap/m/List","sap/m/Bar","sap/m/SearchField","sap/m/StandardListItem","sap/ui/core/InvisibleText","sap/ui/Device"],function(g,h,i,j,k,l,m){R=g;L=h;c=i;S=j;d=k;I=l;D=m;if(!r){sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc",true).then(function(n){r=n;f(true);});}else{f(true);}});}});}this.oReadyPromise.then(function(){this.oPopover=this._createPopover(o,e);return this.oPopover.openBy(o);}.bind(this));};C.prototype._createPopover=function(o,e){var i=new d({title:"{$chart>text}",icon:"{$chart>icon}",selected:"{$chart>selected}"});var l=new L({mode:"SingleSelectMaster",items:{path:"$chart>/getAvailableChartTypes",template:i},selectionChange:function(E){if(E&&E.mParameters&&E.mParameters.listItem){var h=E.mParameters.listItem.getBinding("title");if(h){var j=h.getContext();if(j){var O=j.getObject();if(O&&O.key){e.setChartType(O.key);}}}}p.close();}});var s=new c();var f=new S({placeholder:r.getText("chart.CHART_TYPE_SEARCH")});f.attachLiveChange(function(E){this._triggerSearchInPopover(E,l);});s.addContentRight(f);var p=new R({placement:"Bottom",subHeader:s,contentWidth:"25rem"});p.setModel(this.oChartModel,"$chart");if(D.system.desktop){var g=new I({text:r.getText("chart.CHART_TYPELIST_TEXT")});p.setShowHeader(false);p.addContent(g);p.addAriaLabelledBy(g);}else{p.setTitle(r.getText("chart.CHART_TYPELIST_TEXT"));}p.addContent(l);if(l.getItems().length<7){s.setVisible(false);}return p;};C.prototype.exit=function(){if(this.oPopover){this.oPopover.destroy();this.oPopover=null;}};return C;},true);
