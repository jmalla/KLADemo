/*
 * !SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2018 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/core/Element",'sap/ui/base/SyncPromise',"sap/ui/mdc/library"],function(E,S,M){"use strict";var a,D,T,H;var I=E.extend("sap.ui.mdc.chart.Item",{metadata:{"abstract":true,library:"sap.ui.mdc",properties:{name:{type:"string"},label:{type:"string"},textFormatter:{type:"function"},textProperty:{type:"string"},displayText:{type:"boolean",defaultValue:true},visible:{type:"boolean",defaultValue:true},dataType:{type:"string",defaultValue:"string"},type:{type:"sap.ui.mdc.ChartItemType",defaultValue:null},role:{type:"sap.ui.mdc.ChartItemRoleType",defaultValue:null},inResult:{type:"boolean",defaultValue:false},level:{type:"int",defaultValue:undefined}}},constructor:function(i,s,o){var O={};if(!i){O=s;}else if(typeof i!=="string"){O=i;}else{O=s;O.id=i;}if(!O.type){throw new Error("Missing mandatory property type");}E.apply(this,[O,o]);},applySettings:function(s){if(s.type){this.setType(s.type);delete s.type;}E.prototype.applySettings.apply(this,[s]);},setType:function(t){if(!this.isPropertyInitial(t)){throw new Error("The type property is final and can only be changed at one time");}return this.setProperty("type",t,true);}});I.prototype.getSettings=function(){var s={name:this.getName(),label:this.getLabel(),role:this.getRole()};if(this.getVizItemType()=="Dimension"){s.textProperty=this.getTextProperty();s.displayText=this.getDisplayText();if(this._isHierarchyDimension()){s.level=this.getLevel();}}return s;};I.prototype.toChart=function(c){return new S(function(r){var v,A=this.getVizItemType()=="Measure"?"measures":"dimensions";var w=this.getVizItemType()=="Measure"?c.getDimensionByName(this.getName()):c.getMeasureByName(this.getName());if(w){c.removeAggregation(A,w,true);}var v=this.getVizItemType()=="Measure"?c.getMeasureByName(this.getName()):c.getDimensionByName(this.getName());if(v){v.setRole();}else{this.toVizChartItem().then(function(i){c.addAggregation(A,i,true);});}}.bind(this));};I.prototype.toVizChartItem=function(){return new S(function(r){var v;if(this.getVizItemType()=="Measure"){if(a){v=new a(this.getSettings());r(v);}else{sap.ui.require(["sap/chart/data/Measure"],function(c){a=c;v=new a(this.getSettings());r(v);}.bind(this));}}else{var b,d;if(this._isHierarchyDimension()){b=H;d="sap/chart/data/HierarchyDimension";}else if(this._isTimeDimension()){b=T;d="sap/chart/data/TimeDimension";}else{b=D;d="sap/chart/data/Dimension";}if(b){v=new b(this.getSettings());r(v);}else{sap.ui.require([d],function(c){b=c;v=new b(this.getSettings());r(v);}.bind(this));}}}.bind(this));};I.mSupportedRoles={Dimension:[M.ChartItemRoleType.category,M.ChartItemRoleType.category2,M.ChartItemRoleType.series],Measure:[M.ChartItemRoleType.axis1,M.ChartItemRoleType.axis2,M.ChartItemRoleType.axis3],Aggregatable:[M.ChartItemRoleType.category,M.ChartItemRoleType.category2,M.ChartItemRoleType.series,M.ChartItemRoleType.axis1,M.ChartItemRoleType.axis2,M.ChartItemRoleType.axis3]};I.prototype.setRole=function(r){if(!r){if(this.getVizItemType()=="Measure"){r=M.ChartItemRoleType.axis1;}else{r=M.ChartItemRoleType.category;}}var s=I.mSupportedRoles[this.getVizItemType()];if(!s.indexOf(r)==-1){throw new Error("The role "+r+" is not supported");}this.setProperty("role",r,true);var c=this.getParent();if(c){c.oChartPromise.then(function(v){this.toChart(v);}.bind(this));}return this;};I.prototype.getVizItemType=function(){if(this.getType()==M.ChartItemType.Aggregatable){return I.getRoleType(this.getRole());}return this.getType();};I.prototype._isHierarchyDimension=function(){return false;};I.prototype._isTimeDimension=function(){if(this.getVizItemType()=="Measure"){return false;}switch(this.getDataType()){case"date":case"time":case"datetime":return true;default:return false;}};I.getRoleType=function(r){switch(r){case M.ChartItemRoleType.category:case M.ChartItemRoleType.category2:case M.ChartItemRoleType.series:return"Dimension";}return"Measure";};return I;},true);
