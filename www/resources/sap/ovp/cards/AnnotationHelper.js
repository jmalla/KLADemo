sap.ui.define(["jquery.sap.global","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/ovp/cards/CommonUtils","sap/ui/model/odata/AnnotationHelper","sap/ui/model/FilterOperator","sap/ui/Device","sap/ui/model/analytics/odata4analytics","sap/ui/generic/app/navigation/service/SelectionVariant","sap/ovp/app/resources"],function(q,N,D,C,O,F,a,o,S,b){"use strict";var f={count:0};var c={};var d={};var e={};var g={StateValues:{None:"None",Negative:"Error",Critical:"Warning",Positive:"Success"},ColorValues:{None:"Neutral",Negative:"Error",Critical:"Critical",Positive:"Good"}};var A={TEXT:"com.sap.vocabularies.Common.v1.Text",TEXT_ARRANGEMENT:"com.sap.vocabularies.UI.v1.TextArrangement"};var T={TEXT_LAST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast",TEXT_FIRST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst",TEXT_ONLY:"com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly",TEXT_SEPARATE:"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate"};var I={"List_condensed":{phone:5,tablet:5,desktop:5},"List_extended":{phone:3,tablet:3,desktop:3},"List_condensed_bar":{phone:5,tablet:5,desktop:5},"List_extended_bar":{phone:3,tablet:3,desktop:3},"Table":{phone:5,tablet:5,desktop:5},"Stack_simple":{phone:20,tablet:20,desktop:20},"Stack_complex":{phone:5,tablet:5,desktop:5}};function l(i,j){var k=i.getSetting('ovpCardProperties');var Y2=k.getProperty('/showLabelText');if(Y2==="true"){var Z2=j.Address[0];if(typeof Z2.country!=="undefined"){return"{path:'"+Z2.country.Path+"'}";}else if(typeof Z2.locality!=="undefined"){return"{path:'"+Z2.locality.Path+"'}";}else if(typeof Z2.street!=="undefined"){return"{path:'"+Z2.street.Path+"'}";}else if(typeof Z2.code!=="undefined"){return"{path:'"+Z2.code.Path+"'}";}}else{return null;}}l.requiresIContext=true;function h(i,j){if(!j){return"";}if(j.Label){return j.Label.String;}var k=i.getSetting&&i.getSetting('ovpCardProperties');var Y2=k&&k.getProperty("/metaModel");var Z2=k&&k.getProperty("/entityType");if(!Y2||!Z2){return"";}var $2;if(j.Value){$2=j.Value.Path;}if(j.Target){var _2=E(Z2.$path,j);var a3=_2&&Y2.getProperty(_2);$2=a3&&a3.Value.Path;}if(!$2||!$2.length>0||$2===" "){return"";}var b3=Y2.getODataProperty(Z2,$2);if(!b3){return"";}var c3=b3["sap:label"]||(b3["com.sap.vocabularies.Common.v1.Label"]||"").String||"";return c3;}h.requiresIContext=true;function m(i,k){if(i.getSetting){var j=i.getSetting("_ovpCache");if(j){return j[k];}}return undefined;}function s(i,k,j){if(i.getSetting){var Y2=i.getSetting("_ovpCache");if(Y2){Y2[k]=j;}}}function n(i,j){if(!f[j]){f[j]=0;}f[j]++;var k=j+f[j];f[k]=i;return"sap.ovp.cards.AnnotationHelper.formatFunctions."+k;}function p(i,j){var k;if(j){k=j.None;if(i&&i.EnumMember){var Y2=i.EnumMember;if(t(Y2,'Negative')){k=j.Negative;}else if(t(Y2,'Critical')){k=j.Critical;}else if(t(Y2,'Positive')){k=j.Positive;}}}return k;}function r(i){if(i=="Error"){i=1;}else if(i=="Warning"){i=2;}else if(i=="Success"){i=3;}else{i=0;}return i;}function t(i,j){return i&&i.indexOf(j,i.length-j.length)!==-1;}function u(i,j,k,Y2,Z2,$2,_2){var a3={};a3.EnumMember="None";var b3=Number.NEGATIVE_INFINITY;var c3=Number.POSITIVE_INFINITY;if((!Z2&&Z2!==0)&&(k||k===0)){Z2=k;}if((!$2&&$2!==0)&&(Y2||Y2===0)){$2=Y2;}if(!k&&k!==0){k=b3;}if(!Y2&&Y2!==0){Y2=c3;}if(i!==undefined){i=Number(i);if(t(j,"Minimize")||t(j,"Minimizing")){if(($2||$2===0)&&(Y2||Y2===0)){if(i<=parseFloat($2)){a3.EnumMember="Positive";}else if(i>parseFloat(Y2)){a3.EnumMember="Negative";}else{a3.EnumMember="Critical";}}}else if(t(j,"Maximize")||t(j,"Maximizing")){if((Z2||Z2===0)&&(k||k===0)){if(i>=parseFloat(Z2)){a3.EnumMember="Positive";}else if(i<parseFloat(k)){a3.EnumMember="Negative";}else{a3.EnumMember="Critical";}}}else if(t(j,"Target")){if(($2||$2===0)&&(Y2||Y2===0)&&(Z2||Z2===0)&&(k||k===0)){if(i>=parseFloat(Z2)&&i<=parseFloat($2)){a3.EnumMember="Positive";}else if(i<parseFloat(k)||i>parseFloat(Y2)){a3.EnumMember="Negative";}else{a3.EnumMember="Critical";}}}}return p(a3,_2);}function v(i,j,k,Y2){if(!i||!j){return;}i=Number(i);if(!Y2&&(i-j>=0)){return"sap-icon://trend-up";}if(!k&&(i-j<=0)){return"sap-icon://trend-down";}if(j&&Y2&&(i-j>=Y2)){return"sap-icon://trend-up";}if(j&&k&&(i-j<=k)){return"sap-icon://trend-down";}}function w(i,j){var k=i.getPath(0)+"-DataFields-Sorted";var Y2=m(i,k);if(!Y2){var Z2=x(i,j);var $2=Z2.map(function(_2){return _2.Value.Path;});$2=$2.filter(function(_2){return!!_2;});Y2=j.filter(function(_2){if(_2.RecordType==="com.sap.vocabularies.UI.v1.DataField"&&$2.indexOf(_2.Value.Path)===-1){return true;}return false;});Y2=H(Y2);s(i,k,Y2);}return Y2;}w.requiresIContext=true;function x(j,k,Y2){var Z2=j.getPath(0)+"-DataPoints-Sorted";var $2=m(j,Z2);if(!$2){if(Y2){$2=k.filter(z);}else{$2=k.filter(y);}$2=H($2);var _2;for(var i=0;i<$2.length;i++){_2=j.getPath(0).substr(0,j.getPath(0).lastIndexOf("/")+1);$2[i]=j.getModel(0).getProperty(E(_2,$2[i]));_2="";}s(j,Z2,$2);}return $2;}x.requiresIContext=true;function y(i){if(i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/)){return true;}return false;}function z(i){if((i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/))||(i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.Communication.v1.Contact.*/))){return true;}return false;}function B(i){if(!i||!i.Criticality||!i.Criticality.Path){return;}return"{path:'"+i.Criticality.Path+"'}";}function E(i,j){if(i&&!t(i,'/')){i+='/';}return i+j.Target.AnnotationPath.slice(1);}function G(i){var j,k;if(i["com.sap.vocabularies.UI.v1.Importance"]){j=i["com.sap.vocabularies.UI.v1.Importance"].EnumMember;switch(j){case"com.sap.vocabularies.UI.v1.ImportanceType/High":k=1;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Medium":k=2;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Low":k=3;break;}}else{k=4;}return k;}function H(i){if(i.length<2){return i;}var j=parseInt(i.length/2,10);var k=i.slice(0,j);var Y2=i.slice(j,i.length);return J(H(k),H(Y2));}function J(i,j){var k=[];while(i.length&&j.length){var Y2=G(i[0]),Z2=G(j[0]);if(Y2<=Z2){k.push(i.shift());}else{k.push(j.shift());}}while(i.length){k.push(i.shift());}while(j.length){k.push(j.shift());}return k;}function K(i,j,k){var Y2=w(i,j)[k];if(Y2){return V(i,Y2);}return"";}function L(i,j,k){var Y2=w(i,j)[k];return h(i,Y2);}function M(i,j,k){var Y2=x(i,j)[k];if(Y2&&Y2.Title){return Y2.Title.String;}return"";}function P(i,j,k){var Y2=j.filter(y);Y2=H(Y2);if(!Y2||!Y2.length||!Y2.length>0){return"";}return h(i,Y2[0]);}function Q(i,j,k,Y2){var Z2=x(i,j)[k];if(!Z2){return"";}var $2=i.getSetting('ovpCardProperties');var _2=$2.getProperty("/entityType");var a3=$2.getProperty("/metaModel");return _(i,Z2,_2,a3,Y2);}function R(i,j,k){var Y2=x(i,j)[k];if(Y2&&Y2.Criticality){return true;}}function U(i,j,k){var Y2=x(i,j)[k];var Z2=Y2.Criticality.Path;return"{path:'"+Z2+"'}";}function _(i,j,k,Y2,Z2){if(!j||!j.Value){return"";}var $2=i.getSetting('ovpCardProperties');var _2=false;if($2){var a3=$2.getProperty("/ignoreSapText");_2=a3==undefined?_2:a3;}var b3=Y2.getODataProperty(k,j.Value.Path);var c3=false;if(_2==true){if(b3&&(b3["com.sap.vocabularies.Analytics.v1.Measure"]||b3["sap:aggregation-role"]=="measure")){c3=true;}}if(!c3&&b3){var d3;if(b3["com.sap.vocabularies.Common.v1.Text"]){d3=b3["com.sap.vocabularies.Common.v1.Text"].String?b3["com.sap.vocabularies.Common.v1.Text"].String:b3["com.sap.vocabularies.Common.v1.Text"].Path;}else if(b3["sap:text"]){d3=b3["sap:text"];}if(d3){b3=Y2.getODataProperty(k,d3);j={Value:{Path:b3.name}};}}return V(i,j,Z2);}function V(i,j,k,Y2){if(j.Value.Apply){return O.format(i,j.Value);}var Z2=i.getSetting('ovpCardProperties');var $2=Z2.getProperty("/entityType");var _2=Z2.getProperty("/metaModel");return X(i,j,$2,_2,k,Y2);}V.requiresIContext=true;function W(i,j,k,Y2){if((!k)||(typeof Y2!=='string')){return Y2;}var Z2=k[A.TEXT];if(!Z2){return Y2;}var $2,_2;$2=k[A.TEXT_ARRANGEMENT];_2=$2&&$2.EnumMember;if(!_2){$2=Z2&&Z2[A.TEXT_ARRANGEMENT];_2=$2&&$2.EnumMember;}if(!_2){$2=j&&j[A.TEXT_ARRANGEMENT];_2=$2&&$2.EnumMember;}if(!_2){return Y2;}var a3=O.format(i,Z2);if(!a3||a3===" "){return Y2;}var b3;switch(_2){case T.TEXT_FIRST:b3=a3+" ("+Y2+")";break;case T.TEXT_LAST:b3=Y2+" ("+a3+")";break;case T.TEXT_ONLY:b3=a3;break;case T.TEXT_SEPARATE:b3=Y2+" ("+a3+")";break;default:b3=Y2;break;}return b3;}function X(j,k,Y2,Z2,$2,_2,a3){if(k.Value.Apply){return O.format(j,k.Value);}var b3=k.Value.Path?k.Value.Path:k.Value.String;var c3=Z2.getODataProperty(Y2,b3),d3="",e3;var f3=j.getSetting("ovpCardProperties");var g3=f3&&f3.getProperty("/contentFragment");if(!_2){if(k.Value.Path&&k.Value.Path.split("/").length>1){c3=d1(Z2,Y2,k.Value.Path);}if(!c3){return"";}if(c3["type"]==='Edm.DateTime'||c3["type"]==='Edm.DateTimeOffset'){var h3=f3&&f3.getProperty("/showDateInRelativeFormat");e3=a1("dateFormatFunction",h3,c3["type"]==='Edm.DateTime'?true:false);d3=Y([k.Value.Path?k.Value.Path:c3.name],e3);}else if((k.ValueFormat&&k.ValueFormat.NumberOfFractionalDigits)||c3["scale"]){var i3=(k.ValueFormat&&k.ValueFormat.NumberOfFractionalDigits)?k.ValueFormat.NumberOfFractionalDigits.Int:0,j3;var k3=(k.ValueFormat&&k.ValueFormat.ScaleFactor&&k.ValueFormat.ScaleFactor.Decimal);if(c3["Org.OData.Measures.V1.ISOCurrency"]){j3=c3["Org.OData.Measures.V1.ISOCurrency"].Path?c3["Org.OData.Measures.V1.ISOCurrency"].Path:c3["Org.OData.Measures.V1.ISOCurrency"].String;}else if(c3["Org.OData.Measures.V1.Unit"]){j3=c3["Org.OData.Measures.V1.Unit"].Path?c3["Org.OData.Measures.V1.Unit"].Path:c3["Org.OData.Measures.V1.Unit"].String;}else if(c3["sap:unit"]){j3=c3["sap:unit"];}var l3=j3?Z2.getODataProperty(Y2,j3):null,m3=[k.Value.Path?k.Value.Path:c3.name];if(i3>2){i3=2;}if(c3["Org.OData.Measures.V1.ISOCurrency"]){var n3=c3["Org.OData.Measures.V1.ISOCurrency"];if(n3.Path){e3=b1(i3,k3);m3.push(n3.Path);}else if(n3.String){e3=b1(i3,n3.String,k3);}}else if(l3&&(l3["Org.OData.Measures.V1.ISOCurrency"]||l3["sap:semantics"]==="currency-code")){e3=b1(i3,k3);m3.push(j3);}else{e3=Z(i3,k3);}d3=Y(m3,e3);}else{if(a3){d3=O.simplePath(j,k.Value);}else{var o3=O.format(j.getModel()?j:j.getInterface(0),k.Value);var p3=o3.split(",");var q3=[];if(p3.length>1){for(var i=0;i<p3.length;i++){if(p3[i].indexOf("path:")>=0||p3[i].indexOf("type:")>=0){q3.push(p3[i]);}}if(q3.length>0){d3=d3+q3.join(',');if(d3.substring(d3.length-1)!=="}"){d3=d3+"}";}}}else{d3=o3;}}}if(g3){d3=W(j,Y2,c3,d3);}if(c3["Org.OData.Measures.V1.Unit"]){var r3=c3["Org.OData.Measures.V1.Unit"];if(r3.Path){d3+=(" "+Y([r3.Path]));}else if(r3.String){if(r3.String!=="%"){d3+=" ";}d3+=r3.String;}}}if(!$2){if(c3["Org.OData.Measures.V1.ISOCurrency"]){var n3=c3["Org.OData.Measures.V1.ISOCurrency"];if(n3.Path){d3+=(" "+Y([n3.Path]));}else if(n3.String){d3+=(" "+n3.String);}}}if(d3[0]===" "){d3=d3.substring(1);}return d3;}function Y(j,k){var Y2="",Z2=j.length;if(Z2>1){Y2="{parts:[";for(var i=0;i<Z2;i++){Y2+=("{path: '"+j[i]+"'}"+((i===Z2-1)?"]":", "));}}else{Y2="{path: '"+j[0]+"'";}Y2+=(k?(", formatter: '"+k+"'"):"")+"}";return Y2;}function Z(i,j){var k="formatNumberCalculation"+i;if(!c[k]){c[k]=$(Number(i),j);}return"sap.ovp.cards.AnnotationHelper.NumberFormatFunctions."+k;}function $(i,j){return function(k){var Y2=N.getFloatInstance({style:'short',showMeasure:false,shortRefNumber:j,minFractionDigits:i,maxFractionDigits:i});return Y2.format(Number(k));};}function a1(i,j,k){var Y2={'relative':true,'relativeScale':'auto'};if(j!==undefined&&!j){Y2={'style':'medium'};}if(!d[i]){d[i]=function(Z2){var $2=D.getInstance(Y2);if(!Z2){Z2="";return Z2;}return $2.format(new Date(Z2),k);};}return"sap.ovp.cards.AnnotationHelper.DateFormatFunctions."+i;}function b1(i,j,k){var Y2="formatCurrencyCalculation"+(j?j+i:i);if(!e[Y2]){e[Y2]=c1(i,j,k);}return"sap.ovp.cards.AnnotationHelper.CurrencyFormatFunctions."+Y2;}function c1(i,j,k){return function(Y2,Z2){var $2="";var _2=N.getCurrencyInstance({style:'short',showMeasure:false,shortRefNumber:k,minFractionDigits:i,maxFractionDigits:i});if(Z2){$2=_2.format(Y2,Z2);}else{$2=j?_2.format(Y2,j):_2.format(Y2);}return $2;};}function d1(j,k,Y2){var Z2=Y2.split("/");if(Z2.length>1){for(var i=0;i<(Z2.length-1);i++){var $2=j.getODataAssociationEnd(k,Z2[i]);if($2){k=j.getODataEntityType($2.type);}}return j.getODataProperty(k,Z2[Z2.length-1]);}}function e1(i,j,k){var Y2=x(i,j);var Z2=g.StateValues;var $2=Y2[k];if(!$2){return Z2.None;}if($2.Criticality){return i1(i,$2,Z2);}return k1(i,$2,Z2);}function f1(i,j,k){var Y2=x(i,j);if(Y2&&Y2.length){var Z2=Y2[0];if(Z2&&(Z2.Criticality||Z2.CriticalityCalculation)){return true;}}return false;}function g1(i,j,k){if(f1(i,j,k)){return'';}return'#5cbae6';}g1.requiresIContext=true;function h1(i,j,k){var Y2=x(i,j),Z2=g.ColorValues;var $2=Z2.None;if(Y2.length>k){var _2=Y2[k];if(_2&&_2.Criticality){$2=i1(i,_2,Z2);}else{$2=k1(i,_2,Z2);}}return $2;}function i1(i,j,k){var Y2=k.None;var Z2;var $2=j.Criticality;if($2){Z2="'{'= ({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Negative'') || ({0} === ''1'') || ({0} === 1) ? ''"+k.Negative+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Critical'') || ({0} === ''2'') || ({0} === 2) ? ''"+k.Critical+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Positive'') || ({0} === ''3'') || ({0} === 3) ? ''"+k.Positive+"'' : "+"''"+k.None+"'' '}'";if($2.Path){var _2='$'+O.simplePath(i,$2);Y2=q.sap.formatMessage(Z2,_2);}else if($2.EnumMember){var a3="'"+$2.EnumMember+"'";Y2=q.sap.formatMessage(Z2,a3);}else{q.sap.log.warning("Case not supported, returning the default Neutral state");}}else{q.sap.log.warning("Case not supported, returning the default Neutral state");}return Y2;}function j1(i,j,k){var Y2=x(i,j);var Z2="None";if(Y2.length>k){var $2=Y2[k];if($2&&$2.Criticality&&$2.Criticality.Path){Z2=U(i,j,k);}else{Z2=k1(i,$2,g.StateValues);Z2=r(Z2);}}return Z2;}function k1(i,j,k){var Y2=k.None;if(j.Criticality){Y2=p(j.Criticality,k);}else if(j.CriticalityCalculation&&j.Value&&j.Value&&j.Value.Path){Y2=l1(i,j,k);}return Y2;}function l1(i,j,k){var Y2=B1(j.Value);var Z2=j.CriticalityCalculation.ImprovementDirection.EnumMember;var $2=B1(j.CriticalityCalculation.DeviationRangeLowValue);var _2=B1(j.CriticalityCalculation.DeviationRangeHighValue);var a3=B1(j.CriticalityCalculation.ToleranceRangeLowValue);var b3=B1(j.CriticalityCalculation.ToleranceRangeHighValue);var c3=m1($2);var d3=m1(_2);var e3=m1(a3);var f3=m1(b3);var g3="parts: ["+Y2;g3+=c3?","+$2:"";g3+=d3?","+_2:"";g3+=e3?","+a3:"";g3+=f3?","+b3:"";g3+="]";var h3=function(){var j3=1;return u(arguments[0],Z2,c3?arguments[j3++]:$2,d3?arguments[j3++]:_2,e3?arguments[j3++]:a3,f3?arguments[j3++]:b3,k);};var i3=n(h3,"formatCriticalityCalculation");return"{"+g3+", formatter: '"+i3+"'}";}function m1(i){return(typeof i==="string")&&i.charAt(0)==="{";}function n1(j,k,Y2){var Z2="";var $2=Y2.split("/");if($2.length>1){for(var i=0;i<($2.length-1);i++){var _2=j.getODataAssociationEnd(k,$2[i]);if(_2){k=j.getODataEntityType(_2.type);if(Z2){Z2=Z2+"/";}Z2=Z2+$2[i];}else{return Z2;}}}return Z2;}function o1(j,k){var Y2=j.getSetting('ovpCardProperties');var Z2=Y2.getProperty("/addODataSelect");var $2=Y2.getProperty("/metaModel");var _2=$2.getODataEntityType(k.entityType);var a3=_2[Y2.getProperty('/selectionAnnotationPath')];var b3=_2[Y2.getProperty('/presentationAnnotationPath')];var c3="/"+k.name;var d3=Array.prototype.slice.call(arguments,2);var e3=j.getSetting('ovpCardProperties'),f3=e3.getProperty('/parameters');if(a3||!!f3){if((a3&&a3.Parameters&&a3.Parameters.length>0)||!!f3){c3=v2(j.getSetting('dataModel'),k,a3,f3);}}if(Y2.getProperty("/cardLayout")&&Y2.getProperty("/cardLayout/noOfItems")){var g3="{path: '"+c3+"', length: "+ +(Y2.getProperty("/cardLayout/noOfItems"));}else{var g3="{path: '"+c3+"', length: "+C1(Y2);}var h3=[];if(Z2){h3=q1(j,$2,_2,d3);var i3=Y2.getProperty("/template");if(i3!="sap.ovp.cards.charts.analytical"&&i3!="sap.ovp.cards.charts.smart.chart"){var j3=t1(b3);for(var i=0;i<j3.length;i++){if(!h3.includes(j3[i])){h3.push(j3[i]);}}}}var k3=p1($2,_2,d3);if(h3.length>0||k3.length>0){g3=g3+", parameters: {";if(h3.length>0){g3=g3+"select: '"+h3.join(',')+"'";}if(k3.length>0){if(h3.length>0){g3=g3+", ";}g3=g3+"expand: '"+k3.join(',')+"'";}g3=g3+"}";}var l3=s1(Y2,b3);if(l3.length>0){g3=g3+", sorter:"+JSON.stringify(l3);}var m3=x1(Y2,a3);if(m3.length>0){g3=g3+", filters:"+JSON.stringify(m3);}g3=g3+"}";return g3;}o1.requiresIContext=true;function p1(k,Y2,Z2){var $2=[];var _2,a3,b3,c3;for(var i=0;i<Z2.length;i++){if(!Z2[i]){continue;}_2=Y2.$path+"/"+Z2[i];a3=k.createBindingContext(_2);b3=a3.getObject();b3=b3?b3:[];for(var j=0;j<b3.length;j++){if(b3[j].Value&&b3[j].Value.Path){c3=n1(k,Y2,b3[j].Value.Path);if(c3&&$2.indexOf(c3)===-1){$2.push(c3);}}}}return $2;}function q1(Y2,Z2,$2,_2){var a3=[];var b3,c3,d3;for(var i=0;i<_2.length;i++){if(!_2[i]){continue;}b3=$2.$path+"/"+_2[i];c3=Z2.createBindingContext(b3);var e3={};if(Y2&&Y2.bDummyContext){q.extend(e3,Y2,c3,true);}else{e3=Y2;}d3=c3.getObject();if(!d3){d3=[];}else if(q.isPlainObject(d3)){if(d3.Data){d3=d3.Data;}else{d3=[];}}var f3;var g3;var h3;var i3;for(var j=0;j<d3.length;j++){g3=[];f3=d3[j];h3="";i3=f3.RecordType;if(i3==="com.sap.vocabularies.UI.v1.DataField"){h3=X(e3,f3,$2,Z2,undefined,undefined,true);}else if(i3==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){var j3=E($2.$path,f3);h3=_(e3,Z2.getProperty(j3),$2,Z2);var k3=B(Z2.getProperty(j3));if(k3&&k3.length>0){h3+=k3;}}else if(i3==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"&&f3.Url){var l3;if(!f3.Url.UrlRef){l3=O.format(e3,f3.Url);}if(l3&&l3.substring(0,2)==="{="){h3=l3;}}if(h3){var m3=O.simplePath(e3,f3.Value);if(h3.indexOf("(")<0&&h3!==m3){h3=[].concat(m3,h3).join(" ");}g3=r1(h3);}if(g3&&g3.length>0){var n3;for(var k=0;k<g3.length;k++){n3=g3[k];if(!a3[n3]){a3[n3]=true;var o3=C.getUnitColumn(n3,$2);if(o3&&o3!==n3){a3[o3]=true;}var p3=W2(Z2,$2,n3);if(p3&&p3!==n3){a3[p3]=true;}}}}}}return Object.keys(a3);}function r1(j){var i,k=0,Y2=j.length,Z2="",$2;for(i=0;i<Y2;i++){$2=j.charAt(i);if(!$2){return;}switch($2){case"{":k++;break;case"}":k--;break;default:if(k<=0){continue;}break;}Z2+=$2;}j=Z2;var _2=/\${([a-zA-Z0-9\_|\/]*)/g;var a3=/[^[{]*[a-zA-Z0-9\_]/g;var b3=/path *\: *\'([a-zA-Z0-9\_]+)*\'/g;var c3,d3,e3=[];if(j.indexOf("{parts:[")!==-1){j=j.replace("{parts:[","");}if(j.substring(0,2)==="{="){c3=_2;d3=1;}else if(j.indexOf("path")!==-1){var f3=a3.exec(j);while(f3){if(f3[0].indexOf("path")===-1&&f3[0].indexOf("@i18n")!==0){e3.push(f3[0]);}f3=a3.exec(j);}c3=b3;d3=1;}else{c3=a3;d3=0;}var g3=c3.exec(j);while(g3){if(g3[d3]&&g3[d3].indexOf("@i18n")!==0){e3.push(g3[d3]);}g3=c3.exec(j);}return e3;}function s1(j,k){var Y2=[];var Z2,$2;var _2=j.getProperty("/sortBy");if(_2){var a3=j.getProperty('/sortOrder');if(a3&&a3.toLowerCase()!=='descending'){$2=false;}else{$2=true;}Z2={path:_2,descending:$2};Y2.push(Z2);}var b3=k&&k.SortOrder||undefined;var c3,_2;if(b3){for(var i=0;i<b3.length;i++){c3=b3[i];_2=c3.Property.PropertyPath;$2=y1(c3.Descending,true);Z2={path:_2,descending:$2};Y2.push(Z2);}}return Y2;}function t1(j){var k=[];var Y2=j&&j.RequestAtLeast||undefined;if(Y2){for(var i=0;i<Y2.length;i++){k.push(Y2[i].PropertyPath);}}return k;}function u1(i){var j=i.getProperty('/entityType');var k=j[i.getProperty('/selectionAnnotationPath')];return{filters:x1(i,k),parameters:w1(k)};}function v1(j){if(!j){return;}var k=j.getProperty('/entityType');var Y2=k[j.getProperty('/presentationAnnotationPath')];var Z2=s1(j,Y2);var $2=[];var i,_2=Z2.length;for(i=0;i<_2;i++){if(!Z2[i].path){continue;}$2.push({Property:Z2[i].path,Descending:Z2[i].descending});}if($2.length>0){return{SortOrder:$2};}}function w1(j){var k,Y2=[];if(!j||!j.Parameters){return Y2;}var Z2=j.Parameters.length;for(var i=0;i<Z2;i++){k=j.Parameters[i];if(!k.PropertyName||!k.PropertyName.PropertyPath){continue;}if(!k.PropertyValue){q.sap.log.error("Missing value for parameter "+k.PropertyName.PropertyPath);continue;}Y2[Y2.length]={path:k.PropertyName.PropertyPath,value:A1(k.PropertyValue)};}return Y2;}function x1(k,Y2){var Z2=[];var $2;var _2=k.getProperty("/filters");if(_2){Z2=Z2.concat(_2);}if(Y2&&Y2.SelectOptions){$2=Y2.SelectOptions;}else{$2=Y2;}var a3,b3,c3;if($2){for(var i=0;i<$2.length;i++){a3=$2[i];b3=a3.PropertyName.PropertyPath;for(var j=0;j<a3.Ranges.length;j++){c3=a3.Ranges[j];if(c3.Sign.EnumMember){var d3={path:b3,operator:c3.Option.EnumMember.split("/")[1],value1:A1(c3.Low),value2:A1(c3.High),sign:c3.Sign.EnumMember==="com.sap.vocabularies.UI.v1.SelectionRangeSignType/I"?"I":"E"};if(d3.sign==="E"&&d3.operator!==F.EQ){q.sap.log.error("Exclude sign is supported only with EQ operator");continue;}if(d3.sign==="E"&&d3.operator===F.EQ){d3.operator=F.NE;d3.sign="I";}if(d3.operator==="CP"&&d3.sign==="I"){var e3=F.Contains;var f3=d3.value1;if(f3){var g3=f3.indexOf('*');var h3=f3.lastIndexOf('*');if(g3>-1){if((g3===0)&&(h3!==(f3.length-1))){e3=F.EndsWith;f3=f3.substring(1,f3.length);}else if((g3!==0)&&(h3===(f3.length-1))){e3=F.StartsWith;f3=f3.substring(0,f3.length-1);}else{f3=f3.substring(1,f3.length-1);}}}d3.operator=e3;d3.value1=f3;}Z2.push(d3);}}}}return Z2;}function y1(i,j){if(i&&i.Boolean){if(i.Boolean.toLowerCase()==="true"){return true;}else if(i.Boolean.toLowerCase()==="false"){return false;}}else if(i&&i.Bool){if(i.Bool.toLowerCase()==="true"){return true;}else if(i.Bool.toLowerCase()==="false"){return false;}}return j;}function z1(i){var j;if(i){if(i.String){j=Number(i.String);}else if(i.Int){j=Number(i.Int);}else if(i.Decimal){j=Number(i.Decimal);}else if(i.Double){j=Number(i.Double);}else if(i.Single){j=Number(i.Single);}}return j;}function A1(i){var j;if(i){if(i.String||i.String===""){j=i.String;}else if(i.Boolean||i.Bool){j=y1(i);}else if(i.DateTime){j=i.DateTime;}else{j=z1(i);}}return j;}function B1(i){if(i){if(i.Path){return"{path:'"+i.Path+"'}";}else{return A1(i);}}else{return"";}}function C1(i){var j=i.getProperty('/contentFragment');var k=i.getProperty('/listType');var Y2=i.getProperty('/listFlavor');var Z2;var $2="desktop";if(a.system.phone){$2="phone";}else if(a.system.tablet){$2="tablet";}if(j=="sap.ovp.cards.list.List"){if(k=="extended"){if(Y2=="bar"){Z2=I["List_extended_bar"];}else{Z2=I["List_extended"];}}else if(Y2=="bar"){Z2=I["List_condensed_bar"];}else{Z2=I["List_condensed"];}}else if(j=="sap.ovp.cards.table.Table"){Z2=I["Table"];}else if(j=="sap.ovp.cards.stack.Stack"){if(i.getProperty('/objectStreamCardsNavigationProperty')){Z2=I["Stack_complex"];}else{Z2=I["Stack_simple"];}}if(Z2){return Z2[$2];}return 5;}function D1(i){var j=i.getObject();var k=x(i,j,true);var Y2=k.map(function(Z2){if(Z2&&Z2.Value&&Z2.Value.Path){return Z2.Value.Path;}else if(Z2&&Z2.fn&&Z2.fn.Path){return Z2.fn.Path;}});j.filter(function(Z2,$2){if(Z2.RecordType==="com.sap.vocabularies.UI.v1.DataField"&&Y2.indexOf(Z2.Value.Path)>-1){j.splice($2,1);}});}D1.requiresIContext=true;function E1(i,j){if(j.charAt(0)==='/'||j.indexOf("http")===0){return j;}var k=i.getModel(0).getProperty("/baseUrl");if(k){return k+"/"+j;}return j;}E1.requiresIContext=true;function F1(i,j){var k=x(i,j);return k.length;}F1.requiresIContext=true;function G1(i,j){return I1(i,j,0);}G1.requiresIContext=true;function H1(i,j){return I1(i,j,1);}H1.requiresIContext=true;function I1(i,j,k){var Y2=x(i,j),Z2=Y2[k];if(Z2&&Z2.Value&&Z2.Value.Path){return Z2.Value.Path;}return"";}function J1(i,j){return L(i,j,0);}J1.requiresIContext=true;function K1(i,j){return L(i,j,1);}K1.requiresIContext=true;function L1(i,j){return L(i,j,2);}L1.requiresIContext=true;function M1(i,j){return L(i,j,3);}M1.requiresIContext=true;function N1(i,j){return L(i,j,4);}N1.requiresIContext=true;function O1(i,j,k){return K(i,j,k);}O1.requiresIContext=true;function P1(i,j,k){return Q(i,j,k);}P1.requiresIContext=true;function Q1(i,j,k,Y2){var Z2=F1(i,j);if(Z2>0){return P1(i,j,k);}else{return O1(i,j,Y2);}}Q1.requiresIContext=true;function R1(i,j,k){return k2(i,j,k);}R1.requiresIContext=true;function S1(i,j){return M(i,j,0);}S1.requiresIContext=true;function T1(i,j){return M(i,j,1);}T1.requiresIContext=true;function U1(i,j){return M(i,j,2);}U1.requiresIContext=true;function V1(i,j){return P(i,j,0);}V1.requiresIContext=true;function W1(j,k){for(var i=0;i<k.length;i++){var Y2=k[i];if(Y2.RecordType==="com.sap.vocabularies.UI.v1.DataField"){if(Y2.IconUrl&&Y2.IconUrl.String){return Y2.IconUrl.String;}if(Y2.IconUrl&&Y2.IconUrl.Path){return O.simplePath(j,Y2.IconUrl);}}}}W1.requiresIContext=true;function X1(i,j,k){var Y2="";var Z2;if(q.isArray(j)){Z2=x(i,j)[k];}else{var $2=q.extend({},j);var _2=q.extend({},i);Z2=i2(_2,$2);}if(!Z2||!Z2.Value){return Y2;}var a3=i.getSetting('ovpCardProperties');var b3=a3&&a3.getProperty("/entityType");var c3=a3&&a3.getProperty("/metaModel");var d3=c3&&c3.getODataProperty(b3,Z2.Value.Path);var e3=d3&&d3["Org.OData.Measures.V1.ISOCurrency"];if(e3&&e3.Path){Y2+=(" "+Y([e3.Path]));}else if(e3&&e3.String){Y2+=(" "+e3.String);}return Y2;}X1.requiresIContext=true;function Y1(i,j,k,Y2){return Q(i,j,k,Y2);}Y1.requiresIContext=true;function Z1(i,j){return e1(i,j,0);}Z1.requiresIContext=true;function $1(i,j){return h1(i,j,0);}$1.requiresIContext=true;function _1(i,j){return e1(i,j,1);}_1.requiresIContext=true;function a2(i,j){return e1(i,j,2);}a2.requiresIContext=true;function b2(i,j){return j1(i,j,0);}b2.requiresIContext=true;function c2(i){var j={};j.EnumMember="None";if(Number(i)===1){j.EnumMember="Negative";}else if(Number(i)===2){j.EnumMember="Critical";}else if(Number(i)===3){j.EnumMember="Positive";}return p(j,g.ColorValues);}function d2(i,j){if(j&&j.Criticality&&j.Criticality.Path){return"{parts: [{path:'"+j.Criticality.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.kpiValueCriticality'}";}else{return k1(i,j,g.ColorValues);}}d2.requiresIContext=true;function e2(i,j){return R(i,j,0);}e2.requiresIContext=true;function f2(i,j){var k=x(i,j)[0];if(k&&(k.Criticality||k.CriticalityCalculation)){return true;}return false;}f2.requiresIContext=true;function g2(i,j){return R(i,j,1);}g2.requiresIContext=true;function h2(i,j){return R(i,j,2);}h2.requiresIContext=true;function i2(i,j){var k=i.getPath(0);var Y2=k.slice(0,k.lastIndexOf("/"));Y2=Y2.slice(0,Y2.lastIndexOf("/"));var Z2=E(Y2,j);j=i.getModel(0).getProperty(Z2);return j;}function j2(i,j){if(!j){return"";}return V(i,j);}j2.requiresIContext=true;function k2(j,k,Y2,Z2){var $2;var _2=Z2==undefined?Y2:w(j,Y2)[Z2];var a3=j.getSetting('ovpCardProperties');var b3=a3.getProperty("/metaModel");var c3=b3.getODataEntityType(k.entityType);var d3=c3.property;if(d3){for(var i=0;i<d3.length;i++){if(_2.Value.Path===d3[i].name){$2=d3[i]["com.sap.vocabularies.Common.v1.SemanticObject"];if($2){return O.format(j,$2);}else{return"";}}}}}function l2(i,j,k){var Y2=k===undefined?j.Value.Path:j[k].Value.Path;var Z2=(Y2.indexOf("/")!=-1)?Y2.split('/')[0]:"";return Z2;}l2.requiresIContext=true;function m2(i,j){var k=i.getSetting('ovpCardProperties');var Y2=k.getProperty("/metaModel");var Z2=Y2.getODataEntityType(j.entityType);if(Z2["com.sap.vocabularies.Communication.v1.Contact"]){return true;}return false;}m2.requiresIContext=true;function n2(i,j,k){if(!j){return"";}var Y2=i.getSetting('ovpCardProperties');var Z2=Y2.getProperty("/entityType");var $2=Y2.getProperty("/metaModel");var _2=q.extend({},j);var a3=q.extend({},i);j=i2(a3,_2);return _(i,j,Z2,$2,k);}n2.requiresIContext=true;function o2(i,j){var k=q.extend({},j);var Y2=q.extend({},i);var Z2="None",$2=g.StateValues;j=i2(Y2,k);if(j&&j.Criticality){Z2=i1(i,j,$2);}else{Z2=k1(i,j,$2);}return Z2;}o2.requiresIContext=true;function p2(i,j){var k=q.extend({},j);var Y2=q.extend({},i);j=i2(Y2,k);if(j&&j.Criticality){return true;}}p2.requiresIContext=true;function q2(i,j){var k=q.extend({},j);var Y2=q.extend({},i);var Z2=i.getSetting('ovpCardProperties');var $2=Z2.getProperty("/entityType");var _2=Z2.getProperty("/metaModel");j=i2(Y2,k);if(!j){return;}var a3=_2.getODataProperty($2,j.Value.Path);if(j&&a3&&a3.type=="Edm.String"&&(j.Criticality||j.CriticalityCalculation)){return true;}}q2.requiresIContext=true;function r2(i,j){var k=q.extend({},j);var Y2=q.extend({},i);j=i2(Y2,k);var Z2="None";if(j&&j.Criticality&&j.Criticality.Path){Z2="{path:'"+j.Criticality.Path+"'}";}else{Z2=k1(i,j,g.StateValues);Z2=r(Z2);}return Z2;}r2.requiresIContext=true;function s2(j,k){var Y2;for(var i=0;i<k.length;i++){Y2=k[i];if(Y2.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"||Y2.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||Y2.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){return 1;}}return 0;}s2.requiresIContext=true;function t2(i,j){var k=x(i,j)[0];if(k&&k.Value&&k.Value.Path){var Y2=i.getPath(0).substr(0,i.getPath(0).lastIndexOf("/")+1);var Z2=i.getModel(0);var $2=Z2.getProperty(Y2);var _2=Z2.getODataProperty($2,k.Value.Path);if(_2&&_2["Org.OData.Measures.V1.Unit"]){return _2["Org.OData.Measures.V1.Unit"].String==="%";}}return false;}t2.requiresIContext=true;function u2(i){var j=i.getObject();var k=i.getModel();var Y2=k.getProperty("/metaModel");var Z2=Y2.getODataEntitySet(k.getProperty("/entitySet"));var $2=Y2.getODataEntityType(Z2.entityType);j=$2.$path+"/"+j;return Y2.createBindingContext(j);}function v2(j,k,Y2,Z2,$2){var _2="";var a3=new o.Model(o.Model.ReferenceByModel(j));var b3=a3.findQueryResultByName(k.name);if(!b3){_2="/"+k.name;return _2;}var c3=new o.QueryResultRequest(b3);var d3=b3.getParameterization();if(!d3){_2="/"+k.name;return _2;}if($2){var e3=$2.getAnalyticalParameters();}if(d3){var f3;c3.setParameterizationRequest(new o.ParameterizationRequest(d3));if(Y2&&Y2.Parameters){q.each(Y2.Parameters,function(){if(this.RecordType==="com.sap.vocabularies.UI.v1.IntervalParameter"){f3=this.PropertyNameFrom.PropertyPath.split("/");c3.getParameterizationRequest().setParameterValue(f3[f3.length-1],this.PropertyValueFrom.String,this.PropertyValueTo.String);}else{f3=this.PropertyName.PropertyPath.split("/");c3.getParameterizationRequest().setParameterValue(f3[f3.length-1],this.PropertyValue.String);}});}else if(Z2){q.each(Z2,function(){c3.getParameterizationRequest().setParameterValue(this.path,this.value);});}else if(e3&&e3.length>0){var g3=$2&&$2.getUiState({allFilters:false});var h3=g3?JSON.stringify(g3.getSelectionVariant()):"{}";var Y2=new S(h3);for(var i3 in d3.getAllParameters()){for(var i=0;i<e3.length;i++){if(e3[i]&&(e3[i].name==i3)){var j3=e3[i].name;var k3=Y2.getParameter(j3);if(!k3){var l3=Y2.getSelectOption(j3);k3=l3&&l3[0]&&l3[0].Low;}c3.getParameterizationRequest().setParameterValue(i3,k3);}}}}else{_2="/"+k.name;q.sap.log.error("SelectionParameters","There are no parameters to resolve");return _2;}}try{_2=c3.getURIToQueryResultEntitySet();}catch(m3){b3=c3.getQueryResult();_2="/"+b3.getEntitySet().getQName();q.sap.log.error("getEntitySetPathWithParameters","binding path with parameters failed - "+m3||m3.message);}return _2;}function w2(j,k,ns){var Y2=j.getServiceMetadata().dataServices.schema[0].association;for(var i=0;i<Y2.length;i++){if(ns+"."+Y2[i].name===k){return Y2[i];}}}function x2(i,j){var k=i.filter(function(Z2){if(Z2.RecordType==="com.sap.vocabularies.UI.v1.DataField"){return true;}return false;});var Y2=H(k);if(Y2){return Y2[j];}return;}function y2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=x2(k,0);return k2(i,j,k);}y2.requiresIContext=true;function z2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=x2(k,1);return k2(i,j,k);}z2.requiresIContext=true;function A2(i,j){var k=i.filter(function(Z2){if(Z2.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&Z2.Target.AnnotationPath.indexOf("@com.sap.vocabularies.Communication.v1.Contact")!==-1){return true;}return false;});var Y2=H(k);if(Y2){return Y2[j];}return;}function B2(i){if(!i||!i.length||i.length===0){return false;}var j=A2(i,0);if(j){return true;}return false;}function C2(i,j,k,Y2){var Z2,$2,_2;if(k&&k.Value&&k.Value.Path){Z2=k.Value.Path;}else if(k&&k.Description&&k.Description.Value&&k.Description.Value.Path){Z2=k.Description.Value.Path;}if(k&&k.Description&&k.Description.Path){$2=k.Description.Path;}else if(k&&k.Title&&k.Title.Path){_2=k.Title.Path;}var a3="";var b3=Y2&&Y2.Parameters;var c3="";var d3=i.getSetting('ovpCardProperties'),e3=d3.getProperty('/parameters');b3=b3||!!e3;if(b3){var f3=i.getSetting("dataModel");var g3=v2(f3,j,Y2,e3);a3+="{path: '"+g3+"'";}else{a3+="{path: '/"+j.name+"'";}a3+=", length: 1";var h3=i.getSetting('ovpCardProperties');var i3=h3.getProperty("/entityType");var j3=C.getUnitColumn(Z2,i3);var k3=x1(h3,Y2);if(k3.length>0){c3+=", filters: "+JSON.stringify(k3);}var l3=[];l3.push(Z2);if($2){l3.push($2);}else if(_2){l3.push(_2);}if(k&&k.Criticality&&k.Criticality.Path){l3.push(k.Criticality.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeLowValue&&k.CriticalityCalculation.DeviationRangeLowValue.Path){l3.push(k.CriticalityCalculation.DeviationRangeLowValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeLowValue&&k.CriticalityCalculation.ToleranceRangeLowValue.Path){l3.push(k.CriticalityCalculation.ToleranceRangeLowValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeHighValue&&k.CriticalityCalculation.DeviationRangeHighValue.Path){l3.push(k.CriticalityCalculation.DeviationRangeHighValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeHighValue&&k.CriticalityCalculation.ToleranceRangeHighValue.Path){l3.push(k.CriticalityCalculation.ToleranceRangeHighValue.Path);}if(j3){l3.push(j3);}if(k&&k.TrendCalculation&&k.TrendCalculation.ReferenceValue&&k.TrendCalculation.ReferenceValue.Path){l3.push(k.TrendCalculation.ReferenceValue.Path);}return a3+", parameters:{select:'"+l3.join(",")+"'}"+c3+"}";}C2.requiresIContext=true;function D2(k){if(isNaN(k)){return k;}var i,j,Y2=false;if(this.oPropagatedProperties.oModels.ovpCardProperties.oData.NumberOfFractionalDigits){i=Number(this.oPropagatedProperties.oModels.ovpCardProperties.oData.NumberOfFractionalDigits);}if(this.oPropagatedProperties.oModels.ovpCardProperties.oData.percentageAvailable){Y2=true;}if(!i||i<0){i=0;}else if(i>2){i=2;}j=k;if(k){var Z2=N.getFloatInstance({minFractionDigits:i,maxFractionDigits:i,style:"short",showScale:true,shortRefNumber:j});if(Y2){return Z2.format(Number(k))+" %";}else{return Z2.format(Number(k));}}}function E2(i){if(!i||!i.Value||!i.Value.Path){return"";}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits.Int;}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var Y2=j.getProperty("/metaModel");var Z2=Y2.getODataProperty(k,i.Value.Path);if(Z2["Org.OData.Measures.V1.Unit"]){var $2=Z2["Org.OData.Measures.V1.Unit"];if($2.String=="%"){this.getModel("ovpCardProperties").oData.percentageAvailable=true;}}return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.KpiValueFormatter'}";}function F2(i,j){if(!j||!j.Value||!j.Value.Path||!j.TrendCalculation){return"";}var k=B1(j.Value);var Y2=B1(j.TrendCalculation.ReferenceValue);var Z2=B1(j.TrendCalculation.DownDifference);var $2=B1(j.TrendCalculation.UpDifference);var _2=m1(Y2);var a3=m1(Z2);var b3=m1($2);var c3="parts: ["+k;c3+=_2?","+Y2:"";c3+=a3?","+Z2:"";c3+=b3?","+$2:"";c3+="]";var d3=function(){var f3=1;return v(arguments[0],_2?arguments[f3++]:Y2,a3?arguments[f3++]:Z2,b3?arguments[f3++]:$2);};var e3=n(d3,"formatTrendDirection");return"{"+c3+", formatter: '"+e3+"'}";}F2.requiresIContext=true;function G2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits.Int;}if(i.TrendCalculation.ReferenceValue.Path){return"{parts: [{path:'"+i.Value.Path+"'}, {path:'"+i.TrendCalculation.ReferenceValue.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.returnPercentageChange'}";}else{return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.returnPercentageChange'}";}}function H2(k,i){var j,Y2,Z2,$2,_2=false;if(isNaN(+k)){return"";}if(k==0){$2=i;}else{$2=k;}Y2=this.getModel('ovpCardProperties');if(Y2.getProperty("/iNumberOfFractionalDigits")){Z2=+(Y2.getProperty("/iNumberOfFractionalDigits"));}if(Y2.getProperty("/bPercentageAvailableForTarget")){_2=true;}if(i){j=i;}else{if(Y2.getProperty("/sManifestTargetValue")){j=Y2.getProperty("/sManifestTargetValue");}}if(!Z2||Z2<0){Z2=0;}else if(Z2>2){Z2=2;}if(j){var a3=N.getFloatInstance({minFractionDigits:Z2,maxFractionDigits:Z2,style:"short",showScale:true,shortRefNumber:$2});if(_2){return a3.format(+(j))+" %";}else{return a3.format(+(j));}}}function I2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(!i||!i.Value||!i.Value.Path){return"";}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var Y2=j.getProperty("/metaModel");if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){j.setProperty("/iNumberOfFractionalDigits",i.ValueFormat.NumberOfFractionalDigits.Int);}if(i.TrendCalculation.ReferenceValue){if(i.TrendCalculation.ReferenceValue.String){j.setProperty("/sManifestTargetValue",i.TrendCalculation.ReferenceValue.String);return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.TargetValueFormatter'}";}if(i.TrendCalculation.ReferenceValue.Path){var Z2=Y2.getODataProperty(k,i.TrendCalculation.ReferenceValue.Path);if(Z2["Org.OData.Measures.V1.Unit"]){var $2=Z2["Org.OData.Measures.V1.Unit"];if($2.String=="%"){j.setProperty("/bPercentageAvailableForTarget",true);}}return"{parts: [{path:'"+i.Value.Path+"'},{path:'"+i.TrendCalculation.ReferenceValue.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.TargetValueFormatter'}";}}}function J2(k,i){var j,Y2,Z2;if(isNaN(+k)){return"";}k=+(k);Z2=this.getModel('ovpCardProperties');if(Z2.getProperty("/iNumberOfFractionalDigits")){j=+(Z2.getProperty("/iNumberOfFractionalDigits"));}if(i){Y2=+(i);}else{if(Z2.getProperty("/sManifestTargetValue")){Y2=+(Z2.getProperty("/sManifestTargetValue"));}}if(!j||j<0){j=0;}else if(j>2){j=2;}if(Y2){var $2=((k-Y2)/Y2);var _2=N.getPercentInstance({style:'short',minFractionDigits:j,maxFractionDigits:j,showScale:true});return _2.format($2);}}function K2(i){if(i&&i.GroupBy&&!(q.isEmptyObject(i.GroupBy))&&i.GroupBy[0].hasOwnProperty('PropertyPath')){return true;}else{return false;}}function L2(j,k){var Y2;for(var i=0;j&&i<j.length;i++){if(j[i].value==k){Y2=j[i];break;}}return Y2?Y2.name:null;}function M2(i,k){return L2(i,k);}function N2(i,k){var j=L2(i,k);return j?j:b.getText("OVP_KEYUSER_LABEL_NO_NAVIGATION");}function O2(i){var j="";var k=i&&i.GroupBy;if(!k){return j;}var Y2=this.getModel('ovpCardProperties').getProperty("/metaModel");var Z2=this.getModel('ovpCardProperties').getProperty("/entityType");var $2;if(i.GroupBy.constructor===Array){$2=i.GroupBy;}else if(!i.GroupBy.Collection){return j;}else{$2=i.GroupBy.Collection;}var _2;q.each($2,function(){_2=V2(Y2,Z2,this.PropertyPath);if(!_2){return;}j+=_2;j+=", ";});if(j[j.length-1]===" "&&j[j.length-2]===","){j=j.substring(0,j.length-2);}return j==""?"":b.getText("By",[j]);}function P2(i,j,k){var Y2=true;var Z2=k["SelectOptions"].length-1;if(j.PropertyName.PropertyPath===k["SelectOptions"][Z2].PropertyName.PropertyPath){Y2=false;}j=[j];var $2=i.getSetting('ovpCardProperties');var _2=$2.getProperty("/entityType");var a3=$2.getProperty("/metaModel");var b3=x1($2,j);if(b3.length==0){return"";}var c3;var d3;c3=b3[0].path;d3=W2(a3,_2,c3);if(d3!==c3){return"";}var e3=a3.getODataProperty(_2,j[0].PropertyName.PropertyPath)["type"];var f3=T2(b3,e3);if(Y2===true){return f3+", ";}return f3;}P2.requiresIContext=true;function Q2(i,j,k){var Y2=!(j.index===(k.length-1));var Z2=i.getSetting('ovpCardProperties');var $2=Z2.getProperty("/metaModel");var _2=Z2.getProperty("/entityType");var a3=$2.getODataProperty(_2,k[j.index].path)["type"];var b3=T2([k[j.index]],a3);if(Y2===true){return b3+", ";}return b3;}Q2.requiresIContext=true;function R2(i){return i.id;}function S2(i){return i.id;}function T2(j,k){var Y2=[];for(var i=0;i<j.length;i++){Y2.push(U2(j[i],k));}return Y2.join(', ');}function U2(i,j){var k=false;var Y2,Z2=D.getInstance({'style':'medium'});if(j==='Edm.DateTime'){Y2=Z2.format(new Date(i.value1));}else if(j==='Edm.DateTimeOffset'){Y2=Z2.format(new Date(i.value1),true);}else{Y2=i.value1;}if(i.operator[0]==="N"){k=true;}if(i.value2){if(j==='Edm.DateTime'){Y2+=" - "+Z2.format(new Date(i.value1));}else if(j==='Edm.DateTimeOffset'){Y2+=" - "+Z2.format(new Date(i.value1),true);}else{Y2+=" - "+i.value1;}}if(k){Y2=b.getText("kpiHeader_Filter_NotOperator",[Y2]);}return Y2;}function V2(i,j,k){return X2(i,j,k,"com.sap.vocabularies.Common.v1.Label");}function W2(i,j,k){return X2(i,j,k,"sap:text");}function X2(i,j,k,Y2){var Z2=i.getODataProperty(j,k);if(!Z2){q.sap.log.error("No Property Found for with Name '"+k+" For Entity-Type '"+j.name+"'");return;}var $2=Z2[Y2];if($2){if(Y2==="com.sap.vocabularies.Common.v1.Label"){return $2.String;}return $2;}return Z2.name;}return{NumberFormatFunctions:c,DateFormatFunctions:d,CurrencyFormatFunctions:e,formatFunctions:f,criticalityConstants:g,TextArrangementType:T,getLabelForDataItem:h,colorPaletteForComparisonMicroChart:g1,formatField:V,formatItems:o1,getCardSelections:u1,getCardSorters:v1,getFilters:x1,getPrimitiveValue:A1,getAnnotationLabel:M2,getApplicationName:N2,removeDuplicateDataField:D1,formatUrl:E1,getDataPointsCount:F1,getFirstDataPointValue:G1,getFirstDataFieldName:J1,getSecondDataFieldName:K1,getRequestFields:t1,getThirdDataFieldName:L1,formatDataFieldValueOnIndex:O1,formatDataPointValueOnIndex:P1,formatDataPointOrField:Q1,formatsemanticObjectOfDataFieldGeneric:R1,getLabelForFirstDataPoint:V1,formatImageUrl:W1,formatUnit:X1,formatObjectNumber:Y1,formatFirstDataPointState:Z1,formatFirstDataPointColor:$1,formatSecondDataPointState:_1,formatThirdDataPointState:a2,formatFirstDataPointStateForSmartField:b2,formatKPIHeaderState:d2,isFirstDataPointCriticality:e2,isFirstDataPointCriticalityForTableStatus:f2,getSortedDataFields:w,getSortedDataPoints:x,formatDataFieldValueGeneric:j2,formatDataPointValue:n2,formatDataPointStateGeneric:o2,checkCriticalityGeneric:p2,checkCriticalityGenericForTableStatus:q2,formatDataPointStateForSmartFieldGeneric:r2,hasActions:s2,isFirstDataPointPercentageUnit:t2,resolveEntityTypePath:u2,resolveParameterizedEntitySet:v2,getAssociationObject:w2,semanticObjectOfFirstDataField:y2,semanticObjectOfSecondDataField:z2,isFirstContactAnnotation:B2,getAggregateNumber:C2,KpiValueFormatter:D2,kpiValueCriticality:c2,formThePathForAggregateNumber:E2,formThePathForTrendIcon:F2,formPathForPercentageChange:G2,TargetValueFormatter:H2,formPathForTargetValue:I2,returnPercentageChange:J2,isPresentationVarientPresent:K2,listGroupBy:O2,formTheFilterByString:P2,formTheFilterByStringNotFromSelVar:Q2,formTheIdForFilter:R2,formTheIdForFilterNotFromSelVar:S2,_criticality2state:p,_calculateCriticalityState:u,_calculateTrendDirection:v,_getPropertiesFromBindingString:r1,sortCollectionByImportance:H,checkNavTargetForContactAnno:l2,checkForContactAnnotation:m2};},true);
